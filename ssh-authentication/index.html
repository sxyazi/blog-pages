<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=description content="每次连服务器都要输入一遍密码，非常麻烦。所以可以使用 SSH 公钥来解决总要去输密码的痛苦。 其实一般情况下，购买主机在开通服务前可以添加 SSH 公钥的。 01. 创建 ssh-key 如果已经创建过了，那么可以忽略此过程。 $ ssh-keygen -t rsa 之后根据"><meta name=theme-color media="(prefers-color-scheme: light)" content="white"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#0f172a"><meta property="og:title" content="为 Linux 服务器配置 SSH 公钥认证"><meta property="og:description" content="每次连服务器都要输入一遍密码，非常麻烦。所以可以使用 SSH 公钥来解决总要去输密码的痛苦。 其实一般情况下，购买主机在开通服务前可以添加 SSH 公钥的。 01. 创建 ssh-key 如果已经创建过了，那么可以忽略此过程。 $ ssh-keygen -t rsa 之后根据"><meta property="og:type" content="article"><meta property="og:url" content="https://sxyz.blog/ssh-authentication/"><meta property="og:image" content="https://sxyz.blog/images/others/artwork.jpg"><meta property="article:section" content><meta property="article:published_time" content="2017-04-11T01:00:06+08:00"><meta property="article:modified_time" content="2017-04-11T01:00:06+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sxyz.blog/images/others/artwork.jpg"><meta name=twitter:title content="为 Linux 服务器配置 SSH 公钥认证"><meta name=twitter:description content="每次连服务器都要输入一遍密码，非常麻烦。所以可以使用 SSH 公钥来解决总要去输密码的痛苦。 其实一般情况下，购买主机在开通服务前可以添加 SSH 公钥的。 01. 创建 ssh-key 如果已经创建过了，那么可以忽略此过程。 $ ssh-keygen -t rsa 之后根据"><title data-site="Sxyazi’s blog">为 Linux 服务器配置 SSH 公钥认证 | Sxyazi’s blog</title><link rel=stylesheet href=/assets/index-fad781fe.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=theme-color content="#ffffff"></head><body><main><nav id=nav><a href=/>Home</a><a href=/archives/>Archives</a><a href=/tags/>Tags</a><a href=/links/>Links</a><a href=/about/>About</a></nav><section id=post><h1>为 Linux 服务器配置 SSH 公钥认证</h1><time datetime=2017-04-11T01:00:06+0800>04-11</time>
<span>ssh-authentication</span><div><p>每次连服务器都要输入一遍密码，非常麻烦。所以可以使用 SSH 公钥来解决总要去输密码的痛苦。<p>其实一般情况下，购买主机在开通服务前可以添加 SSH 公钥的。<h2 id=01-创建-ssh-key>01. 创建 ssh-key</h2><p>如果已经创建过了，那么可以忽略此过程。<pre><code class=language-bash>$ ssh-keygen -t rsa
</code></pre><p>之后根据提示录入一些信息即可。<p>创建好后会在 <code>~/.ssh</code> 目录里有 2 个文件，分别是 <code>id_rsa</code> <code>id_rsa.pub</code> ，其中 <code>id_rsa.pub</code> 文件所存放的就是我的公钥了。<h2 id=02-添加公钥到服务器>02. 添加公钥到服务器</h2><h3 id=方法-1自动完成>方法 1：自动完成</h3><pre><code class=language-bash>$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@ip
</code></pre><p>执行后会自动添加公钥到远端服务器中。<h3 id=方法-2手动添加>方法 2：手动添加</h3><p>首先，先把刚才创建好的公钥内容复制出来<pre><code class=language-bash>$ vi ~/.ssh/id_rsa.pub
</code></pre><p>连上远程服务器<pre><code class=language-bash># ssh root@ip
</code></pre><p>然后把刚才复制的公钥重定向到 <code>~/.ssh</code> 目录的 <code>authorized_keys</code> 文件里。<pre><code class=language-bash># echo '刚才copy的内容' &gt;&gt; ~/.ssh/authorized_keys
</code></pre><p>之后修改一下权限<pre><code class=language-bash># chmod 600 ~/.ssh/authorized_keys
</code></pre><h2 id=03-修改配置文件>03. 修改配置文件</h2><p>添加好公钥后，还要让 SSH 支持公钥认证的方式。<p>使用 vi 打开配置文件<pre><code class=language-bash># vi /etc/ssh/sshd_config
</code></pre><p>查找 <code>PubkeyAuthentication</code> 所在的行，把前面 <code>#</code> 去掉，确保 <code>PubkeyAuthentication</code> 是 <code>yes</code> 。<p>最后重启 SSH 服务<pre><code class=language-bash># /etc/init.d/sshd restart
</code></pre></div><ul><li><a href=/tags/linux>Linux</a></ul></section></main><app></app><noscript>You need to enable JavaScript to run this app.</noscript><script type=module crossorigin src=/assets/index-b1ee8dc4.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XWVTHMXTRH"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XWVTHMXTRH")</script></body></html>