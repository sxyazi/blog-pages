<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=description content="上篇文章，把 MySQL 服务环境搭建好了，这篇文章来写一下 MySQL 主从配置。 01. 修改 MySQL 配置文件 my.master.cnf： [mysqld] log-bin = mysql-bin # 二进制日志文件名 server-id = 1 # 服务器ID expire-logs-days = 7 # (可选) 日志有效期[天] replicate-do-db = test # (可选) 要复"><meta name=theme-color media="(prefers-color-scheme: light)" content="white"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#0f172a"><meta property="og:title" content="MySQL 主从配置"><meta property="og:description" content="上篇文章，把 MySQL 服务环境搭建好了，这篇文章来写一下 MySQL 主从配置。 01. 修改 MySQL 配置文件 my.master.cnf： [mysqld] log-bin = mysql-bin # 二进制日志文件名 server-id = 1 # 服务器ID expire-logs-days = 7 # (可选) 日志有效期[天] replicate-do-db = test # (可选) 要复"><meta property="og:type" content="article"><meta property="og:url" content="https://sxyz.blog/mysql-slaves/"><meta property="og:image" content="https://sxyz.blog/images/others/artwork.jpg"><meta property="article:section" content><meta property="article:published_time" content="2017-05-08T01:45:06+08:00"><meta property="article:modified_time" content="2017-05-08T01:45:06+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sxyz.blog/images/others/artwork.jpg"><meta name=twitter:title content="MySQL 主从配置"><meta name=twitter:description content="上篇文章，把 MySQL 服务环境搭建好了，这篇文章来写一下 MySQL 主从配置。 01. 修改 MySQL 配置文件 my.master.cnf： [mysqld] log-bin = mysql-bin # 二进制日志文件名 server-id = 1 # 服务器ID expire-logs-days = 7 # (可选) 日志有效期[天] replicate-do-db = test # (可选) 要复"><title data-site="Sxyazi’s blog">MySQL 主从配置 | Sxyazi’s blog</title><link rel=stylesheet href=/assets/index-fad781fe.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=theme-color content="#ffffff"></head><body><main><nav id=nav><a href=/>Home</a><a href=/archives/>Archives</a><a href=/tags/>Tags</a><a href=/links/>Links</a><a href=/about/>About</a></nav><section id=post><h1>MySQL 主从配置</h1><time datetime=2017-05-08T01:45:06+0800>05-08</time>
<span>mysql-slaves</span><div><p>上篇文章，把 MySQL 服务环境搭建好了，这篇文章来写一下 MySQL 主从配置。<h2 id=01-修改-mysql-配置文件>01. 修改 MySQL 配置文件</h2><p><strong>my.master.cnf：</strong><pre><code class=language-ini>[mysqld]
log-bin          = mysql-bin  # 二进制日志文件名
server-id        = 1          # 服务器ID
expire-logs-days = 7          # (可选) 日志有效期[天]
replicate-do-db  = test       # (可选) 要复制的数据库
binlog-ignore-db = mysql      # (可选) 忽略的数据库
binlog-ignore-db = information_schema
</code></pre><p><strong>my.slave.cnf：</strong><pre><code class=language-ini>[mysqld]
log-bin                = mysql-bin   # (可选) 二进制日志文件名
server-id              = 2           # 服务器ID
replicate-do-db        = test        # (可选) 要复制的数据库
binlog-ignore-db       = mysql       # (可选) 忽略的数据库
replicate-ignore-table = mysql.user  # (可选) 忽略的表
read_only              = 1           # 只读
</code></pre><h2 id=02-启动主从服务>02. 启动主从服务</h2><p>登入到 Master，执行：<pre><code class=language-mysql># 授权 alh@192.168.2.103, 密码为 abcd1234
grant replication slave on *.* to 'alh'@'192.168.2.103' identified by 'abcd1234';
flush privileges;
</code></pre><p>查看 Master 的状态<pre><code class=language-mysql>show master status;

+------------------+----------+--------------+--------------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB         |
+------------------+----------+--------------+--------------------------+
| mysql-bin.000001 |      245 |              | mysql,information_schema |
+------------------+----------+--------------+--------------------------+
1 row in set (0.00 sec)
</code></pre><hr><p>然后切换到 Slave，执行：<pre><code class=language-mysql>change master to
master_host     = '192.168.2.103',    # Master的IP
master_user     = 'alh',              # 刚才授权的账号
master_password = 'abcd1234',         # 刚才授权账号的密码
master_log_file = 'mysql-bin.000001', # 上面状态中的 `File` 字段
master_log_pos  = 245;                # 上面状态中的 `Position` 字段
</code></pre><p>启动 Slave<pre><code class=language-mysql>start slave;
#stop slave  # 终止Slave
</code></pre><p>最后，查看状态是否正常<pre><code class=language-mysql>show slave status \G

Slave_IO_Running:　Yes
Slave_SQL_Running:　Yes
</code></pre></div><ul><li><a href=/tags/mysql>MySQL</a><li><a href=/tags/database>Database</a></ul></section></main><app></app><noscript>You need to enable JavaScript to run this app.</noscript><script type=module crossorigin src=/assets/index-b1ee8dc4.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XWVTHMXTRH"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XWVTHMXTRH")</script></body></html>