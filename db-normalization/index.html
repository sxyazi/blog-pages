<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=description content="设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。 目前关系数据库有六种范式：第一范式（1NF）、第二范式"><meta name=theme-color media="(prefers-color-scheme: light)" content="white"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#0f172a"><meta property="og:title" content="关系型数据库范式"><meta property="og:description" content="设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。 目前关系数据库有六种范式：第一范式（1NF）、第二范式"><meta property="og:type" content="article"><meta property="og:url" content="https://sxyz.blog/db-normalization/"><meta property="og:image" content="https://sxyz.blog/images/others/artwork.jpg"><meta property="article:section" content><meta property="article:published_time" content="2017-05-28T00:00:14+08:00"><meta property="article:modified_time" content="2017-05-28T00:00:14+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sxyz.blog/images/others/artwork.jpg"><meta name=twitter:title content="关系型数据库范式"><meta name=twitter:description content="设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。 目前关系数据库有六种范式：第一范式（1NF）、第二范式"><title data-site="Sxyazi’s blog">关系型数据库范式 | Sxyazi’s blog</title><link rel=stylesheet href=/assets/index-fad781fe.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=theme-color content="#ffffff"></head><body><main><nav id=nav><a href=/>Home</a><a href=/archives/>Archives</a><a href=/tags/>Tags</a><a href=/links/>Links</a><a href=/about/>About</a></nav><section id=post><h1>关系型数据库范式</h1><time datetime=2017-05-28T00:00:14+0800>05-28</time>
<span>db-normalization</span><div><p>设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。<p>目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式(4NF）和第五范式（5NF，又称完美范式）。<p>此文修改整理自：https://www.zhihu.com/question/24696366/answer/29189700<h2 id=01-一些概念>01. 一些概念</h2><h3 id=范式>范式</h3><p>范式是“符合某一种级别的关系模式的集合，表示一个关系内部各属性之间的联系的合理化程度”。实际上你可以把它粗略地理解为 <strong>一张数据表的表结构所符合的某种设计标准的级别</strong>。<h3 id=关系-与-关系模式>关系 与 关系模式</h3><p>“关系”和“关系模式”的区别，类似于面向对象程序设计中”类“与”对象“的区别。”关系“是”关系模式“的一个实例，你可以把”关系”理解为一张带数据的表，而“关系模式”是这张数据表的表结构。<h3 id=元组>元组</h3><p>可以把“元组”理解为一张表中的每条记录，也就是每一行。<h3 id=属性>属性</h3><p>关系里的列。<h3 id=码>码</h3><p>关系中的某个属性或者某几个属性的组合，用于区分每个元组。<h3 id=主属性>主属性</h3><p>包含在任何一个码中的属性称为主属性。<h3 id=异常>异常</h3><p><img src=/images/DB-NF/table.jpg alt><ul><li><strong>插入异常</strong>：无法单独新添加一个系，因为每个系是伴随着学生而存在于这张表中的。<li><strong>删除异常</strong>：若将某个系中的全部学生记录都删掉，那么这个系也不复存在了。<li><strong>修改异常</strong>：假如李小明转系到法律系，那么为了保证数据库中数据的一致性，需要修改三条记录中系与系主任的数据。<li><strong>数据冗余</strong>：每一名学生的学号、姓名、系名、系主任这些数据重复多次。每个系与对应的系主任的数据也重复多次。</ul><h3 id=函数依赖>函数依赖</h3><p>若在一张表中，在属性（或属性组）X 的值确定的情况下，必定能确定属性 Y 的值，那么就可以说 Y 函数依赖于 X，写作 <code>X → Y</code>。<p>也就是说，在数据表中，不存在任意两条记录，它们在 X 属性（或属性组）上的值相同，而在 Y 属性上的值不同。这也就是“函数依赖”名字的由来，类似于函数关系 <code>y = f(x)</code>，在 x 的值确定的情况下，y 的值一定是确定的。<h3 id=部分函数依赖>部分函数依赖</h3><p>假如 Y 函数依赖于 X，但同时 Y 并不完全函数依赖于 X，那么我们就称 Y 部分函数依赖于 X。<h3 id=完全函数依赖>完全函数依赖</h3><p>在一张表中，若 X → Y，且对于 X 的任何一个真子集（假如属性组 X 包含超过一个属性的话），X → Y 不成立，那么我们称 Y 对于 X <strong>完全函数依赖</strong>。<h3 id=传递函数依赖>传递函数依赖</h3><p>假如 Z 函数依赖于 Y，且 Y 函数依赖于 X （严格来说还有一个 X 不包含于 Y，且 Y 不函数依赖于 Z 的前提条件），那么我们就称 Z 函数传递依赖于 X 。<h2 id=02-1nf>02. 1NF</h2><p>定义：<strong>符合 1NF 的关系中的每个属性都不可再分</strong><p><img src=/images/DB-NF/1NF-bad.jpg alt><p>上图中的表就不符合 1NF 的设计规范。<p>事实上，你在关系型数据库中创建的表，都一定满足 1NF 规范。类似于下面的表这样：<p><img src=/images/DB-NF/1NF.jpg alt><p>在符合 1NF 的数据库设计中可能存在着 <strong>异常</strong> ，所以我们需要提高设计标准，去掉导致上述四种问题的因素，使其符合更高一级的范式（2NF），这就是所谓的“规范化”。<h2 id=03-2nf>03. 2NF</h2><p>定义：<strong>2NF 在 1NF 的基础之上，消除了非主属性对于码的部分函数依赖</strong><p><img src=/images/DB-NF/table.jpg alt><p>在上表中，学生信息与课程信息全混在了一张表中：<p>这里的码是 <strong>（学号，课名）</strong>，用它来标识每个元组。<p>对于 <strong>（学号，课名） → 姓名</strong>，有 <strong>学号 → 姓名</strong>，存在非主属性 <strong>姓名 <strong>对码</strong>（学号，课名）</strong> 的部分函数依赖。
对于 <strong>（学号，课名） → 系名</strong>，有 <strong>学号 → 系名</strong>，存在非主属性 <strong>系名 <strong>对码</strong>（学号，课名）</strong> 的部分函数依赖。
对于 <strong>（学号，课名） → 系主任</strong>，有 <strong>学号 → 系主任</strong>，存在非主属性 <strong>系主任</strong> 对码 <strong>（学号，课名）</strong> 的部分函数依赖。<p>所以存在非主属性对于码的部分函数依赖，最高只符合 1NF 的要求，不符合 2NF 的要求。<p>这时候需要对这张表进行拆分：<p><img src=/images/DB-NF/split-table.jpg alt><h2 id=04-3nf>04. 3NF</h2><p>定义：3NF 在 2NF 的基础之上，消除了非主属性对于码的传递函数依赖<p><img src=/images/DB-NF/split-table.jpg alt><p>对于上图中的 <strong>选课</strong> 表，主码为 <strong>（学号，课名）</strong>，主属性为 <strong>学号</strong> 和 <strong>课名</strong>，非主属性只有一个，为 <strong>分数</strong>，不可能存在传递函数依赖，所以 <strong>选课</strong> 表的设计，符合 3NF 的要求。<p>对于上图中的 <strong>学生</strong> 表，主码为 <strong>学号</strong>，主属性为 <strong>学号</strong>，非主属性为 <strong>姓名</strong>、<strong>系名</strong> 和 <strong>系主任</strong>。因为 学号 → 系名，同时 系名 → 系主任，所以存在非主属性 <strong>系主任</strong> 对于码 <strong>学号</strong> 的传递函数依赖，所以 <strong>学生</strong> 表的设计，不符合 3NF 的要求。<p>为了让数据表设计达到 3NF，我们必须进一步进行模式分解为以下形式：
<strong>选课</strong>（学号，课名，分数）
<strong>学生</strong>（学号，姓名，系名）
<strong>系</strong>（系名，系主任）<p><img src=/images/DB-NF/3NF.jpg alt><h2 id=05-bcnf>05. BCNF</h2><p>若：<ol><li>某公司有若干个仓库；<li>每个仓库只能有一名管理员，一名管理员只能在一个仓库中工作；<li>一个仓库中可以存放多种物品，一种物品也可以存放在不同的仓库中。每种物品在每个仓库中都有对应的数量。</ol><p>基于此关系模式的关系（具体的数据）可能如图所示：<p><img src=/images/DB-NF/BCNF.jpg alt><p><strong>函数依赖集</strong>：仓库名 → 管理员，管理员 → 仓库名，（仓库名，物品名）→ 数量
<strong>码</strong> ：（管理员，物品名），（仓库名，物品名）
<strong>主属性</strong> ：仓库名、管理员、物品名
<strong>非主属性</strong> ：数量<p>∵ 此关系模式中不存在 <strong>非主属性</strong> 对 <strong>码</strong> 的 部分函数依赖 和 传递函数依赖。<p>∴ 此关系模式符合 3NF。<p>但是在某些特殊情况下，即使关系模式符合 3NF 的要求，仍然存在着插入异常，修改异常与删除异常等问题，仍然不是 &ldquo;好&rdquo; 的设计。<p>造成此问题的原因：存在着 主属性 对于 码 的 部分函数依赖 与 传递函数依赖。在此例中就是存在主属性 仓库名 对于码的部分函数依赖。<p>解决办法就是要在 3NF 的基础上消除 主属性 对于 码 的部分与传递函数依赖：<p><strong>仓库</strong>（仓库名，管理员）
<strong>库存</strong>（仓库名，物品名，数量）</div><ul><li><a href=/tags/database>Database</a></ul></section></main><app></app><noscript>You need to enable JavaScript to run this app.</noscript><script type=module crossorigin src=/assets/index-b1ee8dc4.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XWVTHMXTRH"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XWVTHMXTRH")</script></body></html>